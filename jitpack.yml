jdk:
  - openjdk17

before_install:
  - bash -lc '
      set -euo pipefail

      export NVM_DIR="$HOME/.nvm"
      mkdir -p "$NVM_DIR"

      # Install nvm (no sudo needed)
      curl -fsSL https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash

      # Load nvm into this shell
      . "$NVM_DIR/nvm.sh"

      # Install and use the exact Node version Dashboard expects
      nvm install 18.12.1
      nvm use 18.12.1

      node -v
      npm -v

      # Yarn classic
      npm i -g yarn@1.22.19
      yarn -v
    '

install:
  - bash -lc '
      set -euo pipefail
      export NVM_DIR="$HOME/.nvm"
      . "$NVM_DIR/nvm.sh"
      nvm use 18.12.1

      ./gradlew build --stacktrace
    '
